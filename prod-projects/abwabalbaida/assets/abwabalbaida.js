const CONFIG={GOOGLE_SHEET_URL:'https://script.google.com/macros/s/AKfycbzFO9jCsaN9vDLOzV73tjCfIzTyl-3gtKIKtDn-tfFNHOOZ1Y9omq262UzXgtXzpFMyDg/exec',FORM_SETTINGS:{showSuccessModal:!0,resetFormOnSuccess:!0,redirectOnSuccess:!1,redirectUrl:'',successDelay:2000},VALIDATION:{phonePattern:/^(\+212|0)[5-7]\d{8}$/,emailPattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},ERROR_MESSAGES:{fullName:'الرجاء إدخال الاسم الكامل',phone:'الرجاء إدخال رقم هاتف صحيح (مثال: +212 6XX XXX XXX)',email:'الرجاء إدخال عنوان بريد إلكتروني صحيح',apartmentType:'الرجاء اختيار نوع الشقة',budget:'الرجاء اختيار الميزانية التقديرية',visitInterest:'الرجاء الإجابة على سؤال الزيارة',submissionFailed:'حدث خطأ أثناء الإرسال. الرجاء المحاولة مرة أخرى.',networkError:'خطأ في الاتصال. الرجاء التحقق من اتصالك بالإنترنت.'},SUCCESS_MESSAGES:{title:'تم الإرسال بنجاح!',text:'شكراً لك. سنتواصل معك في أقرب وقت ممكن.'}};const Validation={validateFullName(name){return name&&name.trim().length>=3},validatePhone(phone){return CONFIG.VALIDATION.phonePattern.test(phone.trim())},validateEmail(email){if(!email||email.trim()===''){return !0}return CONFIG.VALIDATION.emailPattern.test(email.trim())},validateRadio(name){const selected=document.querySelector(`input[name="${name}"]:checked`);return selected!==null},showError(fieldId,message){const errorElement=document.getElementById(`${fieldId}Error`);const inputElement=document.getElementById(fieldId)||document.querySelector(`input[name="${fieldId}"]`);if(errorElement){errorElement.textContent=message;errorElement.style.display='block'}if(inputElement){if(inputElement.classList){inputElement.classList.add('error')}if(inputElement.type==='radio'){const radios=document.querySelectorAll(`input[name="${fieldId}"]`);radios.forEach(radio=>{const label=radio.closest('.radio-label');if(label){label.style.borderColor='var(--error-color)'}})}}},clearError(fieldId){const errorElement=document.getElementById(`${fieldId}Error`);const inputElement=document.getElementById(fieldId)||document.querySelector(`input[name="${fieldId}"]`);if(errorElement){errorElement.textContent='';errorElement.style.display='none'}if(inputElement){if(inputElement.classList){inputElement.classList.remove('error')}if(inputElement.type==='radio'){const radios=document.querySelectorAll(`input[name="${fieldId}"]`);radios.forEach(radio=>{const label=radio.closest('.radio-label');if(label){label.style.borderColor=''}})}}},clearAllErrors(){const errorElements=document.querySelectorAll('.error-message');errorElements.forEach(error=>{error.textContent='';error.style.display='none'});const inputElements=document.querySelectorAll('.form-control.error');inputElements.forEach(input=>{input.classList.remove('error')});const radioLabels=document.querySelectorAll('.radio-label');radioLabels.forEach(label=>{label.style.borderColor=''})},validateForm(formData){const errors={};let isValid=!0;this.clearAllErrors();if(!this.validateFullName(formData.fullName)){errors.fullName=CONFIG.ERROR_MESSAGES.fullName;this.showError('fullName',errors.fullName);isValid=!1}if(!this.validatePhone(formData.phone)){errors.phone=CONFIG.ERROR_MESSAGES.phone;this.showError('phone',errors.phone);isValid=!1}if(!this.validateEmail(formData.email)){errors.email=CONFIG.ERROR_MESSAGES.email;this.showError('email',errors.email);isValid=!1}if(!this.validateRadio('apartmentType')){errors.apartmentType=CONFIG.ERROR_MESSAGES.apartmentType;this.showError('apartmentType',errors.apartmentType);isValid=!1}if(!this.validateRadio('budget')){errors.budget=CONFIG.ERROR_MESSAGES.budget;this.showError('budget',errors.budget);isValid=!1}if(!this.validateRadio('visitInterest')){errors.visitInterest=CONFIG.ERROR_MESSAGES.visitInterest;this.showError('visitInterest',errors.visitInterest);isValid=!1}return{isValid,errors}}};const GoogleSheets={async submitToGoogleSheets(formData){if(!CONFIG.GOOGLE_SHEET_URL||CONFIG.GOOGLE_SHEET_URL==='YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE'){console.error('Google Sheets URL not configured');console.log('Form data:',formData);return new Promise((resolve)=>{setTimeout(()=>{resolve({success:!0,message:'تم الإرسال بنجاح (وضع التطوير)',data:formData})},1000)})}try{const response=await fetch(CONFIG.GOOGLE_SHEET_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});return{success:!0,message:CONFIG.SUCCESS_MESSAGES.text}}catch(error){console.error('Error submitting to Google Sheets:',error);throw new Error(CONFIG.ERROR_MESSAGES.networkError)}},prepareFormData(formData){const now=new Date();const formattedDate=now.toLocaleDateString('fr-FR',{day:'2-digit',month:'short',year:'numeric'});const formattedTime=now.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'});const data={timestamp:`${formattedDate}, ${formattedTime}`,fullName:formData.get('fullName')?.trim()||'',phone:formData.get('phone')?.trim()||'',email:formData.get('email')?.trim()||'',apartmentType:formData.get('apartmentType')||'',budget:formData.get('budget')||'',visitInterest:formData.get('visitInterest')||''};data.apartmentTypeLabel=this.getApartmentTypeLabel(data.apartmentType);data.budgetLabel=this.getBudgetLabel(data.budget);data.visitInterestLabel=this.getVisitInterestLabel(data.visitInterest);return data},getApartmentTypeLabel(value){const labels={'2-bedrooms':'شقة بغرفتين','3-bedrooms':'شقة بثلاث غرف'};return labels[value]||value},getBudgetLabel(value){const labels={'less-than-300k':'أقل من 300,000 درهم','300k-400k':'بين 300,000 و 400,000 درهم','more-than-400k':'أكثر من 400,000 درهم'};return labels[value]||value},getVisitInterestLabel(value){const labels={'yes':'نعم، في أقرب وقت ممكن','no':'لا، ليس الآن'};return labels[value]||value}};document.addEventListener('DOMContentLoaded',function(){hidePreloader();AOS.init({duration:800,easing:'ease-in-out',once:!0,offset:50,delay:0,mirror:!1,anchorPlacement:'top-bottom'});initHeader();initSmoothScroll();initForm();initModal();initAnimations()});function hidePreloader(){const preloader=document.getElementById('preloader');if(preloader){setTimeout(()=>{preloader.classList.add('fade-out');setTimeout(()=>{preloader.style.display='none'},500)},3000)}}window.addEventListener('load',function(){hidePreloader()});function initHeader(){const header=document.getElementById('header');const mobileMenuToggle=document.getElementById('mobileMenuToggle');let lastScroll=0;window.addEventListener('scroll',()=>{const currentScroll=window.pageYOffset;if(currentScroll>100){header.style.boxShadow='var(--shadow-lg)'}else{header.style.boxShadow='var(--shadow-md)'}lastScroll=currentScroll});if(mobileMenuToggle){mobileMenuToggle.addEventListener('click',()=>{const nav=document.querySelector('.nav');mobileMenuToggle.classList.toggle('active');nav.classList.toggle('active')});const navLinks=document.querySelectorAll('.nav-link');navLinks.forEach(link=>{link.addEventListener('click',()=>{const nav=document.querySelector('.nav');mobileMenuToggle.classList.remove('active');nav.classList.remove('active')})})}}function initSmoothScroll(){const links=document.querySelectorAll('a[href^="#"]');links.forEach(link=>{link.addEventListener('click',function(e){const href=this.getAttribute('href');if(href==='#')return;e.preventDefault();const target=document.querySelector(href);if(target){const headerHeight=document.getElementById('header').offsetHeight;const targetPosition=target.offsetTop-headerHeight;window.scrollTo({top:targetPosition,behavior:'smooth'})}})})}function initForm(){const form=document.getElementById('contactForm');const submitBtn=document.getElementById('submitBtn');const btnText=submitBtn.querySelector('.btn-text');const btnLoader=submitBtn.querySelector('.btn-loader');const inputs=form.querySelectorAll('input');inputs.forEach(input=>{input.addEventListener('blur',function(){validateSingleField(this)});input.addEventListener('input',function(){const fieldId=this.id||this.name;Validation.clearError(fieldId)})});form.addEventListener('submit',async function(e){e.preventDefault();const formData=new FormData(form);const data={fullName:formData.get('fullName'),phone:formData.get('phone'),email:formData.get('email'),apartmentType:formData.get('apartmentType'),budget:formData.get('budget'),visitInterest:formData.get('visitInterest')};const validation=Validation.validateForm(data);if(!validation.isValid){const firstError=form.querySelector('.error-message[style*="block"]');if(firstError){firstError.scrollIntoView({behavior:'smooth',block:'center'})}return}submitBtn.disabled=!0;btnText.style.display='none';btnLoader.style.display='inline-block';try{const preparedData=GoogleSheets.prepareFormData(formData);const result=await GoogleSheets.submitToGoogleSheets(preparedData);if(result.success){showSuccessModal();if(CONFIG.FORM_SETTINGS.resetFormOnSuccess){setTimeout(()=>{form.reset();Validation.clearAllErrors()},500)}if(CONFIG.FORM_SETTINGS.redirectOnSuccess&&CONFIG.FORM_SETTINGS.redirectUrl){setTimeout(()=>{window.location.href=CONFIG.FORM_SETTINGS.redirectUrl},CONFIG.FORM_SETTINGS.successDelay)}}else{throw new Error(result.message||CONFIG.ERROR_MESSAGES.submissionFailed)}}catch(error){console.error('Form submission error:',error);showErrorModal(error.message||CONFIG.ERROR_MESSAGES.submissionFailed)}finally{submitBtn.disabled=!1;btnText.style.display='inline-block';btnLoader.style.display='none'}})}function validateSingleField(input){const fieldId=input.id||input.name;const value=input.value;switch(fieldId){case 'fullName':if(!Validation.validateFullName(value)){Validation.showError(fieldId,CONFIG.ERROR_MESSAGES.fullName)}break;case 'phone':if(!Validation.validatePhone(value)){Validation.showError(fieldId,CONFIG.ERROR_MESSAGES.phone)}break;case 'email':if(value&&!Validation.validateEmail(value)){Validation.showError(fieldId,CONFIG.ERROR_MESSAGES.email)}break}}function initModal(){const modal=document.getElementById('successModal');const closeModalBtn=document.getElementById('closeModal');const modalOverlay=modal.querySelector('.modal-overlay');closeModalBtn.addEventListener('click',closeModal);modalOverlay.addEventListener('click',closeModal);document.addEventListener('keydown',(e)=>{if(e.key==='Escape'&&modal.classList.contains('active')){closeModal()}})}function showSuccessModal(){const modal=document.getElementById('successModal');modal.classList.add('active');document.body.style.overflow='hidden'}function showErrorModal(message){let errorModal=document.getElementById('errorModal');if(!errorModal){errorModal=document.createElement('div');errorModal.id='errorModal';errorModal.className='modal';errorModal.innerHTML=`<div class="modal-overlay"></div><div class="modal-content"><div class="modal-icon error-icon"><i class="fas fa-exclamation-circle"></i></div><h3 class="modal-title">عذراً، حدث خطأ</h3><p class="modal-message" id="errorMessage">${message}</p><button class="modal-btn" id="closeErrorModal">حسناً</button></div>`;document.body.appendChild(errorModal);errorModal.querySelector('.modal-overlay').addEventListener('click',()=>closeErrorModal());errorModal.querySelector('#closeErrorModal').addEventListener('click',()=>closeErrorModal())}else{document.getElementById('errorMessage').textContent=message}errorModal.classList.add('active');document.body.style.overflow='hidden'}function closeErrorModal(){const errorModal=document.getElementById('errorModal');if(errorModal){errorModal.classList.remove('active');document.body.style.overflow=''}}function closeModal(){const modal=document.getElementById('successModal');modal.classList.remove('active');document.body.style.overflow=''}function initAnimations(){const observerOptions={threshold:0.1,rootMargin:'0px 0px -50px 0px'};const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.style.opacity='1';entry.target.style.transform='translateY(0)'}})},observerOptions);const animateElements=document.querySelectorAll('.feature-card, .gallery-item, .about-content');animateElements.forEach(el=>{el.style.opacity='0';el.style.transform='translateY(30px)';el.style.transition='opacity 0.6s ease-out, transform 0.6s ease-out';observer.observe(el)})}function debounce(func,wait){let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}}function formatPhoneNumber(input){let value=input.value.replace(/\D/g,'');if(value.startsWith('212')){value='+'+value}else if(value.startsWith('0')){}input.value=value}const phoneInput=document.getElementById('phone');if(phoneInput){phoneInput.addEventListener('input',function(){formatPhoneNumber(this)})}